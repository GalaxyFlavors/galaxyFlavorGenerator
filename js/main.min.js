"use strict";function inArray(e,t){return e.filter(function(e){return e.repo_owner_username===t.repo_owner_username&&e.name===t.name}).length>0}function doASearch(e){if(e.state.searchText.length>=3){var t=e.state.searchCount+1;e.setState({searchCount:t}),e.setState({loading:!0}),search(e.state.searchText,e.state.shed.url,function(a){if(e.state.searchCount==t){var n=[];a.map(function(t){e.state.added.filter(function(e){t.id==e.id&&(t.added=!0)}),n.push(t)}),e.setState({found:n}),e.setState({loading:!1})}else console.log("not returning the results of this search")})}}function search(e,t,a){var n=t+e+"&jsonp=true";currentSearch&&currentSearch.abort(),currentSearch=$.ajax({type:"GET",url:n,crossDomain:!0,dataType:"jsonp",success:function(e){var t=[];e.hits.map(function(e){inArray(t,e.repository)||t.push(e.repository)}),a(t)}})}function uniq_fast(e){for(var t={},a=[],n=e.length,r=0,s=0;n>s;s++){var c=e[s];1!==t[c]&&(t[c]=1,a[r++]=c)}return a}function fillSearchResults(e){searchResultsDiv.empty(),e.map(function(e){searchResultsDiv.append("<p>"+e.name+"</p>"),searchResultsDiv.append(e.name)})}function isEvenNumber(e){return isNumber(e)&&e%2==0}function isNumber(e){return e==parseFloat(e)}function generateDockerFile(e){var t="";t+="FROM "+e.baseimage+"\n\n",t+="MAINTAINER Björn A. Grüning, bjoern.gruening@gmail.com\n\n",t+='ENV GALAXY_CONFIG_BRAND "'+e.GALAXY_CONFIG_BRAND+'"\n\n',t+="WORKDIR /galaxy-central\n\n";var a="",n=e.shed.uri;if(e.added.length>=1){a+="RUN install-repository \\ \n";var r=0;e.added.forEach(function(t){r++;var s="\\";r==e.added.length&&(s=""),a+='    "--url '+n+" -o "+t.repo_owner_username+" --name "+t.name+'" '+s+"\n"})}t+=a+"\n",t+='VOLUME ["/export/", "/data/", "/var/lib/docker"]\n\n',t+="EXPOSE :80\n",t+="EXPOSE :21\n",t+="EXPOSE :8080\n\n",t+='CMD ["/usr/bin/startup"]\n',downloadString(t,"Dockerfile")}function downloadString(e,t){var a=new Blob([e]);saveAs(a,t)}var sheds=[{name:"Main ToolShed",shortName:"main",uri:"https://toolshed.g2.bx.psu.edu/",url:"https://toolshed.g2.bx.psu.edu/api/repositories?q="}],RepositoriesFound=React.createClass({displayName:"RepositoriesFound",render:function(){var e=this.props.found.length>0?"border":"";return React.createElement("ul",{className:e},this.props.found.map(function(e,t){var a=isEvenNumber(t)?"":"zebra",n=e.description,r="";return e.added?React.createElement("li",{className:a,"data-tooltip":n},React.createElement("span",null,e.name),React.createElement("div",{className:"button-block"},React.createElement("span",{className:"button thin right disabled"},"Added"))):(e.remote_repository_url&&e.remote_repository_url.length>0&&(r=React.createElement("a",{href:e.remote_repository_url,target:"_blank",className:"button primary thin right"},"Source Code")),React.createElement("li",{className:a,"data-tooltip":n},React.createElement("span",null,e.name),React.createElement("div",{className:"button-block"},React.createElement("button",{className:"success thin right",onClick:this.props.addToAdded.bind(this,e)},"Add"),r)))},this))}}),SearchInput=React.createClass({displayName:"SearchInput",render:function(){for(var e=[],t=0;t<sheds.length;t++)e.push(React.createElement("option",{value:t},sheds[t].name));return React.createElement("div",{className:"row squish"},React.createElement("div",{className:"col8"},React.createElement("input",{type:"text",key:"searchBox",onChange:this.props.onSearchChange,min:"3"})),React.createElement("div",{className:"col4"},React.createElement("select",{onChange:this.props.changeShed},e)))}}),Loading=React.createClass({displayName:"Loading",render:function(){var e=this.props.loading?"sk-fading-circle":"";return React.createElement("div",{className:e},React.createElement("div",{className:"sk-circle1 sk-circle"}),React.createElement("div",{className:"sk-circle2 sk-circle"}),React.createElement("div",{className:"sk-circle3 sk-circle"}),React.createElement("div",{className:"sk-circle4 sk-circle"}),React.createElement("div",{className:"sk-circle5 sk-circle"}),React.createElement("div",{className:"sk-circle6 sk-circle"}),React.createElement("div",{className:"sk-circle7 sk-circle"}),React.createElement("div",{className:"sk-circle8 sk-circle"}),React.createElement("div",{className:"sk-circle9 sk-circle"}),React.createElement("div",{className:"sk-circle10 sk-circle"}),React.createElement("div",{className:"sk-circle11 sk-circle"}),React.createElement("div",{className:"sk-circle12 sk-circle"}))}}),RepositoriessList=React.createClass({displayName:"RepositoriessList",render:function(){var e=this.props.added.length>0?"border":"",t=this;return React.createElement("ul",{className:e},this.props.added.map(function(e,a){var n=isEvenNumber(a)?"":"zebra";return React.createElement("li",{className:n},React.createElement("span",null,e.name),React.createElement("div",{className:"button-block"},React.createElement("button",{className:"error thin right",onClick:t.props.removeFromAdded.bind(this,e)},"Remove"),React.createElement("div",{className:"shed-badge"},e.shed.shortName)))}))}}),FlavorApp=React.createClass({displayName:"FlavorApp",getInitialState:function(){return{added:[],found:[],loading:!1,searchText:"",shed:sheds[0],searchCount:0,GALAXY_CONFIG_BRAND:"Galaxy",images:[],baseimage:"bgruening/galaxy-stable"}},loadImages:function(){var e="http://github-raw-cors-proxy.herokuapp.com/galaxyFlavorsGenerators/galaxyFlavorGenerator/blob/master/resources/flavors.json";$.ajax({url:e,dataType:"json",success:function(e){console.log(e),this.setState({images:e})}.bind(this),error:function(e,t,a){console.error(this.props.url,t,a.toString())}.bind(this)})},componentDidMount:function(){this.loadImages()},imageChange:function(e){console.log("State changed to "+e.target.value),this.setState({baseimage:e.target.value||null})},onSearchChange:function(e){this.setState({searchText:e.target.value}),doASearch(this)},addToAdded:function(e){var t=this.state.added.filter(function(t){return t.repo_owner_username===e.repo_owner_username&&t.name===e.name}).length>0;if(!t){var a=this.state.added.concat([e]),n=this,r=[];this.state.found.map(function(t){t.repo_owner_username===e.repo_owner_username&&t.name===e.name&&(t.added=!0),t.shed=n.state.shed,r.push(t)}),this.setState({added:a,found:r})}},changeBrand:function(e){console.log(e.target.value);var t=e.target.value;t.length>0&&this.setState({GALAXY_CONFIG_BRAND:t})},changeShed:function(e){var t=sheds[parseInt(e.target.value)];this.setState({shed:t}),doASearch(this)},removeFromAdded:function(e){var t=this.state.added.filter(function(t){return e!=t}),a=[];this.state.found.map(function(t){t.repo_owner_username===e.repo_owner_username&&t.name===e.name&&(t.added=!1),a.push(t)}),this.setState({added:t,found:a})},render:function(){var e="hidden";this.state.added.length>0&&(e="");var t=this.state.images.map(function(e){return React.createElement("option",{value:e.name},e.name)});return React.createElement("div",{className:"container"},React.createElement("h2",null,"Please add repositories you would like to have in your Galaxy"),React.createElement("div",{id:"search"},React.createElement(SearchInput,{onSearchChange:this.onSearchChange,changeShed:this.changeShed}),React.createElement(Loading,{loading:this.state.loading,key:"loading"}),React.createElement(RepositoriesFound,{found:this.state.found,addToAdded:this.addToAdded,key:"repositoriesFound"})),React.createElement("hr",null),React.createElement("h3",null,"Config"),React.createElement("div",{className:"row"},React.createElement("div",{className:"col12"},React.createElement("div",null,React.createElement("label",null,"Base galaxy image:"),React.createElement("select",{onChange:this.imageChange},t)),React.createElement("label",null,"GALAXY_CONFIG_BRAND"),React.createElement("input",{type:"text",placeholder:"Galaxy",onChange:this.changeBrand}),React.createElement("label",null,"Galaxy release"),React.createElement("select",null,React.createElement("option",null,"15.05")))),React.createElement("hr",null),React.createElement("div",{className:e},React.createElement("div",{className:"row"},React.createElement("div",{className:"col12"},React.createElement("h3",{className:"no-margin-top"},"Your Galaxy will have the following:")))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col8"},React.createElement("div",{id:"repositories-added"},React.createElement(RepositoriessList,{added:this.state.added,removeFromAdded:this.removeFromAdded}))),React.createElement("div",{className:"col4"},React.createElement("button",{className:"button full-width",onClick:generateDockerFile.bind(this,this.state)},"Give me a Docker"),React.createElement("button",{className:"button full-width",disabled:!0},"Give me a VM"),React.createElement("button",{className:"button full-width",disabled:!0},"Give me a Cloud"))))}});React.render(React.createElement(FlavorApp,null),document.getElementById("app"));var searchResultsDiv=$("#search-results"),currentSearch;$("#search-input").on("input",function(){var e=$(this).val();search(e)});
>>>>>>> quick change to get 'one-file' working
